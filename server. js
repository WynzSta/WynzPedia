const express = require("express");
const bodyParser = require("body-parser");
const cors = require("cors");

const app = express();
app.use(cors());
app.use(bodyParser.json());

// Tempat penyimpanan server (sementara, bukan database)
let servers = [];

/* ===========================
   CREATE SERVER
=========================== */
app.post("/create", (req, res) => {
    const { name, email, ram, cpu } = req.body;

    if (!name || !email || !ram || !cpu) {
        return res.status(400).json({ message: "Data tidak lengkap!" });
    }

    const newServer = {
        id: Date.now().toString(),
        name,
        email,
        ram,
        cpu,
        url: `https://mycloud.fake/${name.toLowerCase()}-${Math.floor(Math.random()*9999)}`
    };

    servers.push(newServer);

    res.json({
        message: "Server berhasil dibuat!",
        server: newServer
    });
});

/* ===========================
   GET ALL SERVERS (untuk list)
=========================== */
app.get("/servers", (req, res) => {
    res.json(servers);
});

/* ===========================
   DELETE SERVER
=========================== */
app.post("/delete", (req, res) => {
    const { id } = req.body;

    if (!id) {
        return res.status(400).json({ message: "ID server tidak ditemukan." });
    }

    const before = servers.length;
    servers = servers.filter(s => s.id !== id);

    if (servers.length === before) {
        return res.status(404).json({ message: "Server tidak ditemukan!" });
    }

    res.json({ message: "Server berhasil dihapus." });
});

/* ===========================
   ABOUT INFO (developer)
=========================== */
app.get("/about", (req, res) => {
    res.json({
        developer: "Faxzy",
        date_created: "16 November 2025",
        contact: "+628xxxxxxxxx",
        version: "1.0"
    });
});

/* ===========================
   START SERVER
=========================== */
app.listen(3000, () => {
    console.log("Server berjalan di http://localhost:3000");
});
